# v2 linear K=41 scaled to ~10M params
#
# Scale-up from 5M: d_model 256→384, hidden 1024→1280.
# Linear input projection (d_model >> input_dim, zero-padding would waste 257/384 dims).

model:
  version: v2
  input_mode: linear
  max_pulses_per_dom: 41
  d_model: 384
  max_doms: 128
  num_heads: 8
  num_layers: 6
  hidden_dim: 1280
  head_hidden_dim: 1024
  dropout: 0.1

training:
  epochs: 10
  batch_size: 4096
  lr: 3e-4
  warmup_steps: 2000
  weight_decay: 0.01
  gradient_clip: 1.0
  use_amp: true

data:
  max_events: 200000000
  val_events: 1000000
  num_workers: 8
  geometry_path: /groups/pheno/inar/icecube_kaggle/sensor_geometry_normalized.csv
  train_batches: [1, 650]
  val_batches: [651, 655]
  val_per_epoch: 5

wandb:
  enabled: true
  project: iceaggr
  name: null
  tags:
    - flat-transformer-v2
    - K41
    - 10M-params
    - input-linear
    - scale-up

checkpoint:
  dir: checkpoints
  save_every: 5
  resume: null
